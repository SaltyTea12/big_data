# Лабораторная работа №1
## Introduction to Apache Spark

В ходе лабораторной работы был выполнен ряд заданий по исследованию данных о поездках на велосипедах и станциях, ниже представлены скриншоты результатов и краткое описание хода выполнения заданий

**1. Найти велосипед с максимальным временем пробега.** 

Здесь происходит группировка данных по 'bike_id' и вычисление максимальной длительности поездки для каждого велосипеда, затем происходит сортировка результатов по убыванию длительности и вывод первой строки, что и будет являться ответом

![image](https://github.com/user-attachments/assets/1f4ed9b7-c241-45b9-a724-2aeafd95f5de)


**2. Найти наибольшее геодезическое расстояние между станциями.**  

Выбираются столбцы 'id', 'lat' и 'long' из DataFrame stations и сохранение в переменной stations_data, 
создаются комбинации станций и выбор только различных комбинаций, затем вычисляется евклидово расстояние между двумя точками, после чего находится максимальное  

![image](https://github.com/user-attachments/assets/2b365f79-12ac-4759-97fa-bb2064de6828)

**3. Найти путь велосипеда с максимальным временем пробега через станции.**

Выбираются столбцы 'id', 'bike_id', 'start_station_id' и 'end_station_id' из DataFrame df_trips, 
затем происходит фильтрация по 'bike_id' равному 535 и сортировка по 'id', далее вывод отфильтрованных по условиям данных и количества строк

![image](https://github.com/user-attachments/assets/1b71d4ef-c0cd-4664-8716-edeab57aee31)

**4. Найти количество велосипедов в системе.**

![image](https://github.com/user-attachments/assets/7d0871c6-8e51-400c-942b-9d8c13093b3e)

**5. Найти пользователей потративших на поездки более 3 часов.**

Фильтруем данные, оставляя только те записи, где продолжительность поездки больше или равна 10800 секунд (3 часа)

![image](https://github.com/user-attachments/assets/e5e144df-a1a3-4462-8ccc-a26969a4e0d4)
